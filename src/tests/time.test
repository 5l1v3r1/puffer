#!/bin/bash -ex

# create reference time files
TIME_REF1="1970-01-01T00:00:02Z"
TIME_REF2="1970-01-01T00:00:04Z"
REF_NAME1="$test_tmpdir/time_ref1"
REF_NAME2="$test_tmpdir/time_ref2"

printf $TIME_REF1 > $REF_NAME1
printf $TIME_REF2 > $REF_NAME2

# remove time_test if exists
TIME=$abs_builddir/../time/time
TEST_NAME="$test_tmpdir/time_test"
rm -f $TEST_NAME

# test time.cc with two new "files"
TEST_TIME1="180180.m4s"
TEST_TIME2="360360.m4s"

$TIME -o $TEST_NAME $TEST_TIME1
diff $REF_NAME1 $TEST_NAME

# increase
$TIME -o $TEST_NAME $TEST_TIME2
diff $REF_NAME2 $TEST_NAME

# decrease
$TIME -o $TEST_NAME $TEST_TIME1
diff $REF_NAME2 $TEST_NAME
